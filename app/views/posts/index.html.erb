<div class="page-header d-flex justify-content-between align-items-center mb-4">
  <h1 class="h3">Blog Posts</h1>
  <% if logged_in? %>
    <%= link_to new_post_path, class: "btn btn-primary" do %>
      <i class="fas fa-plus-circle me-2"></i>New Post
    <% end %>
  <% end %>
</div>

<% if @posts.any? %>
  <div class="row">
    <% @posts.each do |post| %>
      <div class="col-md-6 col-lg-4 mb-4">
        <div class="card post-card h-100 border-0 shadow-sm">
          <div class="card-body">
            <h2 class="card-title h5 mb-2"><%= link_to post.title, post_path(post), class: "text-decoration-none stretched-link" %></h2>
            <div class="post-meta text-muted mb-2">
              <small>
                <i class="fas fa-user me-1"></i> <%= link_to post.user.username, user_path(post.user), class: "text-muted" %>
                <span class="mx-1">â€¢</span>
                <i class="far fa-clock me-1"></i> <%= time_ago_in_words(post.created_at) %> ago
              </small>
            </div>
            <p class="card-text text-truncate-3"><%= truncate(post.content, length: 120) %></p>
          </div>
          <div class="card-footer bg-transparent border-top-0 pt-0">
            <div class="d-flex justify-content-between">
              <div>
                <% if post.categories.any? %>
                  <% post.categories.take(2).each do |category| %>
                    <%= link_to category.name, category_path(category), class: "badge rounded-pill bg-secondary text-decoration-none me-1" %>
                  <% end %>
                  <% if post.categories.count > 2 %>
                    <span class="badge rounded-pill bg-light text-dark">+<%= post.categories.count - 2 %></span>
                  <% end %>
                <% end %>
              </div>
              <small class="text-muted">
                <i class="far fa-comment me-1"></i><%= post.comments.count %>
              </small>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>

  <div class="pagination-container mt-4">
    <%= will_paginate @posts, class: 'pagination justify-content-center' %>
  </div>
<% else %>
  <div class="text-center p-5 bg-light rounded">
    <i class="fas fa-newspaper fa-3x text-muted mb-3"></i>
    <h3>No posts available</h3>
    <p class="text-muted">Be the first to share something interesting!</p>
    <% if logged_in? %>
      <%= link_to "Create Post", new_post_path, class: "btn btn-primary mt-2" %>
    <% else %>
      <%= link_to "Sign Up to Post", signup_path, class: "btn btn-primary mt-2" %>
    <% end %>
  </div>
<% end %>